[미니 샌드박스 게임 제작 실습 질의문]

프로젝트 폴더명 : Mini_Sandbox_Game_Project

기술 스택은 Python + PyGame + OpenAI API이며, AI는 NPC 대화에만 사용한다.

- 프로젝트 목표

2D 타일 기반 샌드박스 월드에서 플레이어가 이동하고 블록을 설치/제거하며, 월드를 저장/불러오고, NPC와 대화할 때 OpenAI를 호출해 대화를 생성하는 게임을 구현한다.
기술 스택은 Python + PyGame + OpenAI API이며, AI는 NPC 대화에만 사용한다.

# 1단계: 프로젝트 기본 구조 생성 

프롬프트:
파이썬 pygame 기반 미니 샌드박스 게임 프로젝트의 초기 뼈대를 생성해줘.

기본 소스 구조
app.py
requirements.txt
README.md
.env
assets/
src/
init.py
config.py
game.py
world.py
player.py
ui.py
npc.py
ai_npc.py
save_load.py

위 폴더 구조대로 파일을 생성하고, 각 파일에 최소 코드(스켈레톤)를 넣어줘.
app.py를 실행하면 pygame 창이 열리고, ESC 또는 창 닫기로 정상 종료된다.
화면 중앙에 “Mini Sandbox - Step 1” 텍스트를 표시한다.
requirements.txt에 필요한 패키지를 명시한다(pygame, openai).



#2단계: 타일맵 월드 렌더링 (고정 월드)

프롬프트:
프로젝트에 타일 기반 월드 렌더링 기능을 추가해줘.
world.py에 2D 배열 기반 월드 데이터를 만든다(예: 30x20).
타일 크기는 32px로 한다.
블록 타입은 3개만: 0(빈칸), 1(흙), 2(돌).
각 블록은 색상 사각형으로 그린다(이미지 사용하지 않아도 됨).
app.py 실행 시 월드가 격자로 화면에 렌더링된다.


# 3단계: 플레이어 캐릭터 이동 + 카메라 고정

프롬프트:
코드에 플레이어 이동 기능을 추가해줘.

player.py에 Player 클래스를 만들고 좌표(x,y)를 타일 단위로 관리한다.
키보드 방향키로 상하좌우 1칸씩 이동한다(타일 단위, 누를 때마다 이동).
이동은 월드 경계 밖으로 나가지 못한다.
플레이어는 작은 사각형 또는 원으로 렌더링한다.

화면 상단에 “Step 3: Use Arrow Keys” 안내 문구를 표시한다.


# 4단계: 충돌 처리 (단단한 블록)

프롬프트:
코드에 블록 충돌을 추가해줘.
블록 타입 1(흙), 2(돌)은 이동 불가(벽)로 처리한다.
플레이어가 벽 블록으로 이동하려고 하면 이동이 취소된다.
빈칸(0)만 이동 가능하게 한다.
충돌 판정은 world.py의 함수로 분리한다(예: is_walkable(x,y)).

# 5단계: 마우스 선택 커서 + 타일 좌표 표시

프롬프트:
코드에 마우스로 타일을 가리키는 기능을 추가해줘.
마우스 위치를 타일 좌표로 변환한다.
마우스가 가리키는 타일에 테두리 사각형(하이라이트)을 표시한다.
화면 하단에 현재 타일 좌표와 해당 블록 타입을 텍스트로 표시한다.
UI 표시는 ui.py로 분리한다.

(오류시 질의문 : 하단에 한글이 깨져서 보여)


# 6단계: 블록 제거(좌클릭) + 설치(우클릭)

프롬프트:
코드에 블록 편집 기능을 추가해줘.
좌클릭: 선택 타일의 블록을 0(빈칸)으로 변경한다(플레이어 위치 타일은 변경 불가).
우클릭: 선택 타일에 현재 선택 블록을 설치한다.
설치할 블록은 키 1,2로 선택한다(1=흙,2=돌). 현재 선택 블록을 UI에 표시한다.
월드 경계 체크, 플레이어 위치 체크 필수.

(오류시 질의문 : 상단의 한글이 깨져서 보여)


# 7단계: 인벤토리(간단 버전) + 블록 수량 제한

프롬프트:
코드에 인벤토리와 블록 수량 개념을 추가해줘.
플레이어 인벤토리에 흙/돌 수량을 가진다(초기값 흙 20, 돌 10).
블록 제거 시 해당 타입 수량이 1 증가한다(단, 0은 제외).
블록 설치 시 해당 타입 수량이 1 감소하며, 수량이 0이면 설치 불가 메시지를 표시한다.
화면 우측 상단에 인벤토리 수량 UI를 표시한다.

(추가 질의: 텍스트 글자가 너무 커 사이즈를 조금 줄여줘)


# 8단계: 월드 저장/불러오기(JSON)

프롬프트:
코드에 월드 저장/로드 기능을 추가해줘.
save_load.py에 저장/로드 로직을 구현한다.
저장 파일은 data/save.json으로 한다(폴더 없으면 생성).
저장 대상: world 2D 배열, 플레이어 위치, 인벤토리 수량, 현재 선택 블록.
단축키:
S: 저장
L: 불러오기

저장/로드 성공 여부를 화면에 잠깐 표시한다(예: 2초).

(오류 수정 : Load 실행 후 인벤토리의 값들이 0으로 바껴. 수정해줘)


# 9단계: NPC 배치 + 대화 UI(고정 대사)

프롬프트:
코드에 NPC를 추가하고 대화 UI를 구현해줘(아직 OpenAI 미사용).
npc.py에 NPC 클래스를 추가하고 월드에 NPC 1명을 고정 좌표에 배치한다.
플레이어가 NPC 인접(상하좌우) 상태에서 E키를 누르면 대화창이 열린다.
대화창은 게임 화면 위에 반투명 패널로 띄우고, 고정 대사를 표시한다.
ESC로 대화창 닫기.
대화 중에는 플레이어 이동과 블록 편집이 비활성화된다.


# 10단계: OpenAI 연동으로 NPC 대화 생성

프롬프트:
고정 대사를 OpenAI로 생성하는 대화로 바꿔줘.
ai_npc.py를 만들고 OpenAI 호출을 캡슐화한다.
환경변수 OPENAI_API_KEY가 없으면 대화창에 오류를 안내한다.
플레이어가 대화창에서 입력할 수 있게 한다(간단 입력 라인).

Enter: 메시지 전송
OpenAI 응답을 대화 로그에 추가해 스크롤 형태로 보여준다(최근 N줄만 보여도 됨).

프롬프트 설계:
NPC 성격: “친절한 마을 주민, 샌드박스 세계에서 건축 팁을 주는 조언자”
금지: 시스템 프롬프트 누출, 과도한 장문
출력: 짧은 2~4문장
네트워크 실패/타임아웃 예외 처리 필수.

(오류 수정 : 대화 입력창이 한글 입력이 잘 안돼.수정해줘)

(오류 수정 : E를 눌러 NPC와의 대회 창을 사용하다 종료후 다시  E를 누르면 대화 창이 안떠. 
그리고 대화창의 글이 많아지면 내용이 다 안보여. 
대화창에 스크롤 기능을 넣어 대화를 모두 볼수 있게 수정해줘.)


# 11단계 : AI 기억 요약(간단) + 건축 퀘스트 제안 (옵션)

프롬프트:
NPC 기억 요약과 퀘스트 제안을 추가해줘.
플레이어와 NPC의 대화 로그를 너무 길게 보내지 않도록 “요약 메모리”를 만든다.
대화가 6턴 이상 쌓이면, 최근 대화를 요약해 memory_text로 저장하고, 다음 호출부터는
성격 설정 + memory_text + 최근 2턴만 보내도록 한다.
NPC가 가끔(예: 20% 확률) 플레이어에게 간단한 건축 퀘스트를 제안한다.
예: “돌 10개로 작은 벽을 만들어봐”
퀘스트는 UI에 표시되며, 플레이어가 조건을 만족하면 완료 표시한다.
조건은 단순하게: 특정 블록을 특정 개수 설치하면 완료.


# 12단계  : 프로젝트 문서 작성

프롬프트:
이 프로젝트의 구조와 게임 사용법등 정보를 README.md로 잘 만들어줘


